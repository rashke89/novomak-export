{"ast":null,"code":"var _jsxFileName = \"/Users/radosmijatovic/projects/novomak-export/frontend/src/screens/CategoriesScreen.js\";\nimport React, { useEffect, useState } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport axios from 'axios';\nimport { saveProduct, listProducts, deleteProdcut } from '../actions/productActions';\nimport { deleteCategory, listCategories, saveCategory } from \"../actions/categoryAction\";\nimport { CATEGORY_SAVE_REQUEST } from \"../constants/categoryConstants\";\n\nfunction CategoriesScreen(props) {\n  var _categorySave$categor;\n\n  const [modalVisible, setModalVisible] = useState(false);\n  const [id, setId] = useState('');\n  const [name, setName] = useState('');\n  const [image, setImage] = useState('');\n  const [discount, setDiscount] = useState('');\n  const [usedCategories, setUsedCategories] = useState([]);\n  const [selectedCategory, setSelectedCategory] = useState('categories');\n  const categoryList = useSelector(state => state.categoryList.categories);\n  const categorySave = useSelector(state => state.categorySave);\n  const {\n    categories,\n    diameters,\n    manufacturers,\n    heights,\n    widths,\n    seasons\n  } = categoryList;\n  const [renderList, setRenderList] = useState(categories);\n  const productSave = useSelector(state => state.productSave);\n  const {\n    loading: loadingSave,\n    success: successSave,\n    error: errorSave\n  } = productSave;\n  const productDelete = useSelector(state => state.productDelete);\n  const {\n    loading: loadingDelete,\n    success: successDelete,\n    error: errorDelete\n  } = productDelete;\n  const dispatch = useDispatch();\n  useEffect(() => {\n    // if (successSave) {\n    //     setModalVisible(false);\n    // }\n    dispatch(listCategories());\n    setRenderList(categories);\n    return () => {//\n    };\n  }, [successSave, successDelete]);\n  useEffect(() => {\n    setRenderList(categoryList[selectedCategory]);\n    return () => {//\n    };\n  }, [categories]);\n\n  const openModal = product => {\n    console.log('aaaaaaa', product);\n    setId(product._id);\n    setName(product.name);\n    if (product === null || product === void 0 ? void 0 : product.usedCategories) setUsedCategories(product.usedCategories);\n    if (product === null || product === void 0 ? void 0 : product.discount) setDiscount(product.discount);else setDiscount('');\n    console.log(usedCategories);\n  };\n\n  const submitHandler = e => {\n    e.preventDefault();\n    dispatch(saveCategory({\n      _id: id,\n      selectedCategory,\n      name,\n      discount,\n      image,\n      usedCategories\n    }));\n  };\n\n  const deleteHandler = product => {\n    dispatch(deleteCategory({\n      id: product._id,\n      selectedCategory\n    }));\n  };\n\n  const onChoseCategory = categoryName => {\n    setRenderList(categoryList[categoryName]);\n    setSelectedCategory(categoryName);\n  };\n\n  const uploadFileHandler = e => {\n    const file = e.target.files[0];\n    const bodyFormData = new FormData();\n    bodyFormData.append('image', file);\n    axios.post('/api/uploads/category-image', bodyFormData, {\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      }\n    }).then(response => {\n      setImage(response.data);\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n\n  const isChecked = categoryName => {\n    console.log(categoryName);\n    return usedCategories.findIndex(item => item === categoryName) >= 0 ? true : false;\n  };\n\n  const handleChangeMarks = category => {\n    console.log(category);\n    var usedCat = usedCategories;\n    var foundIndex = usedCat.findIndex(item => item === category.name);\n\n    if (foundIndex >= 0) {\n      usedCat.splice(foundIndex, 1);\n    } else {\n      usedCat.push(category.name);\n    }\n\n    console.log(usedCat);\n    setUsedCategories(usedCat);\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"content content-margined\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"product-header mb-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"ul\", {\n    className: \"nav header-list\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"li\", {\n    className: \"nav-item\",\n    onClick: e => onChoseCategory('categories'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: `nav-link ${selectedCategory === 'categories' && 'active'}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 25\n    }\n  }, \"Kategorije\")), /*#__PURE__*/React.createElement(\"li\", {\n    className: \"nav-item\",\n    onClick: e => onChoseCategory('manufacturers'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: `nav-link ${selectedCategory === 'manufacturers' && 'active'}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 25\n    }\n  }, \"Proizvodjaci\")), /*#__PURE__*/React.createElement(\"li\", {\n    className: \"nav-item\",\n    onClick: e => onChoseCategory('seasons'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: `nav-link ${selectedCategory === 'seasons' && 'active'}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 25\n    }\n  }, \"Sezone\")), /*#__PURE__*/React.createElement(\"li\", {\n    className: \"nav-item\",\n    onClick: e => onChoseCategory('widths'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: `nav-link ${selectedCategory === 'widths' && 'active'}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 25\n    }\n  }, \"Sirina\")), /*#__PURE__*/React.createElement(\"li\", {\n    className: \"nav-item\",\n    onClick: e => onChoseCategory('heights'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: `nav-link ${selectedCategory === 'heights' && 'active'}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 25\n    }\n  }, \"Visina\")), /*#__PURE__*/React.createElement(\"li\", {\n    className: \"nav-item\",\n    onClick: e => onChoseCategory('diameters'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: `nav-link ${selectedCategory === 'diameters' && 'active'}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 25\n    }\n  }, \"Precnik\"))), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    className: \"btn btn-primary\",\n    \"data-toggle\": \"modal\",\n    \"data-target\": \"#exampleModal\",\n    onClick: e => openModal({\n      name: '',\n      id: ''\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 17\n    }\n  }, \"Kreiraj kategoriju\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"modal fade bd-example-modal-lg\",\n    id: \"exampleModal\",\n    tabIndex: \"-1\",\n    role: \"dialog\",\n    \"aria-labelledby\": \"exampleModalLabel\",\n    \"aria-hidden\": \"true\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"modal-dialog\",\n    role: \"document\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"modal-content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"modal-header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    className: \"modal-title\",\n    id: \"exampleModalLabel\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 29\n    }\n  }, id ? 'Izmeni' : 'Kreiraj', \" kategoriju\"), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    className: \"close\",\n    \"data-dismiss\": \"modal\",\n    \"aria-label\": \"Close\",\n    onClick: e => {\n      dispatch({\n        type: CATEGORY_SAVE_REQUEST,\n        payload: ''\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    \"aria-hidden\": \"true\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 33\n    }\n  }, \"\\xD7\"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"modal-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-modal\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: submitHandler,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 37\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: `${selectedCategory === 'categories' ? 'col-md-6' : 'col-md-12'}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 41\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 45\n    }\n  }, \"Ime\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    name: \"name\",\n    value: name,\n    id: \"name\",\n    onChange: e => setName(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 45\n    }\n  })), selectedCategory === 'widths' || selectedCategory === 'heights' || selectedCategory === 'diameters' ? /*#__PURE__*/React.createElement(\"div\", {\n    className: 'col-md-12',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 144\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    onChange: null,\n    className: \"marked-inputs\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 45\n    }\n  }, usedCategories ? categories === null || categories === void 0 ? void 0 : categories.map(item => {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: item._id,\n      className: \"input-field\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 64\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"checkbox\",\n      value: item.name,\n      onChange: e => handleChangeMarks(item),\n      name: item.name,\n      defaultChecked: isChecked(item.name),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 108\n      }\n    }), \" \", item.name);\n  }) : '')) : '', selectedCategory === 'categories' && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-md-6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 79\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"brand\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 45\n    }\n  }, \"Rabat (%)\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"number\",\n    name: \"brand\",\n    value: discount,\n    id: \"brand\",\n    onChange: e => setDiscount(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 45\n    }\n  })), selectedCategory === 'categories' && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-md-6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 79\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"image\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 45\n    }\n  }, \"Slika\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    name: \"image\",\n    value: image,\n    id: \"image\",\n    onChange: e => setImage(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 45\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"file\",\n    className: \"w-100\",\n    onChange: uploadFileHandler,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 45\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-md-12\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 41\n    }\n  }, categorySave && categorySave.hasOwnProperty('loading') && !categorySave.loading && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-md-12 mt-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 129\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: !(categorySave === null || categorySave === void 0 ? void 0 : categorySave.success) ? 'error-text p-3' : 'success-text p-3',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 49\n    }\n  }, \"[STATUS] \", id ? 'izmena' : 'kreiranje', \" kategorije: \", categorySave === null || categorySave === void 0 ? void 0 : (_categorySave$categor = categorySave.category) === null || _categorySave$categor === void 0 ? void 0 : _categorySave$categor.message))))))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"modal-footer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    className: \"btn btn-secondary\",\n    id: \"close-modal-btn\",\n    \"data-dismiss\": \"modal\",\n    onClick: e => {\n      dispatch({\n        type: CATEGORY_SAVE_REQUEST,\n        payload: ''\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 29\n    }\n  }, \"Odustani\"), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"submit\",\n    className: \"btn btn-primary\",\n    onClick: submitHandler,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 29\n    }\n  }, id ? 'Izmeni' : 'Kreiraj'))))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"product-list\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 14\n    }\n  }, /*#__PURE__*/React.createElement(\"table\", {\n    className: \"table\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"thead\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 244,\n      columnNumber: 25\n    }\n  }, \"ID\"), /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 25\n    }\n  }, \"Naziv\"), /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 25\n    }\n  }))), /*#__PURE__*/React.createElement(\"tbody\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 21\n    }\n  }, renderList === null || renderList === void 0 ? void 0 : renderList.map(product => /*#__PURE__*/React.createElement(\"tr\", {\n    key: product._id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"td\", {\n    className: \"align-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 29\n    }\n  }, product._id), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 29\n    }\n  }, product.name), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    \"data-toggle\": \"modal\",\n    \"data-target\": \"#exampleModal\",\n    className: \"button\",\n    onClick: () => openModal(product),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 33\n    }\n  }, \"Izmeni\"), ' ', /*#__PURE__*/React.createElement(\"button\", {\n    className: \"button\",\n    onClick: () => deleteHandler(product),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 259,\n      columnNumber: 33\n    }\n  }, \"Obrisi\"))))))));\n}\n\nexport default CategoriesScreen;","map":{"version":3,"sources":["/Users/radosmijatovic/projects/novomak-export/frontend/src/screens/CategoriesScreen.js"],"names":["React","useEffect","useState","useSelector","useDispatch","axios","saveProduct","listProducts","deleteProdcut","deleteCategory","listCategories","saveCategory","CATEGORY_SAVE_REQUEST","CategoriesScreen","props","modalVisible","setModalVisible","id","setId","name","setName","image","setImage","discount","setDiscount","usedCategories","setUsedCategories","selectedCategory","setSelectedCategory","categoryList","state","categories","categorySave","diameters","manufacturers","heights","widths","seasons","renderList","setRenderList","productSave","loading","loadingSave","success","successSave","error","errorSave","productDelete","loadingDelete","successDelete","errorDelete","dispatch","openModal","product","console","log","_id","submitHandler","e","preventDefault","deleteHandler","onChoseCategory","categoryName","uploadFileHandler","file","target","files","bodyFormData","FormData","append","post","headers","then","response","data","catch","err","isChecked","findIndex","item","handleChangeMarks","category","usedCat","foundIndex","splice","push","type","payload","value","map","hasOwnProperty","message"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from 'react';\nimport {useSelector, useDispatch} from 'react-redux';\nimport axios from 'axios';\nimport {\n    saveProduct,\n    listProducts,\n    deleteProdcut,\n} from '../actions/productActions';\nimport {deleteCategory, listCategories, saveCategory} from \"../actions/categoryAction\";\nimport {CATEGORY_SAVE_REQUEST} from \"../constants/categoryConstants\";\n\nfunction CategoriesScreen(props) {\n    const [modalVisible, setModalVisible] = useState(false);\n    const [id, setId] = useState('');\n    const [name, setName] = useState('');\n    const [image, setImage] = useState('');\n    const [discount, setDiscount] = useState('');\n    const [usedCategories, setUsedCategories] = useState([]);\n    const [selectedCategory, setSelectedCategory] = useState('categories');\n    const categoryList = useSelector((state) => state.categoryList.categories);\n    const categorySave = useSelector((state) => state.categorySave);\n    const {categories, diameters, manufacturers, heights, widths, seasons} = categoryList;\n    const [renderList, setRenderList] = useState(categories);\n\n    const productSave = useSelector((state) => state.productSave);\n    const {\n        loading: loadingSave,\n        success: successSave,\n        error: errorSave,\n    } = productSave;\n\n    const productDelete = useSelector((state) => state.productDelete);\n    const {\n        loading: loadingDelete,\n        success: successDelete,\n        error: errorDelete,\n    } = productDelete;\n    const dispatch = useDispatch();\n\n    useEffect(() => {\n        // if (successSave) {\n        //     setModalVisible(false);\n        // }\n        dispatch(listCategories());\n        setRenderList(categories);\n        return () => {\n            //\n        };\n    }, [successSave, successDelete]);\n\n    useEffect(() => {\n        setRenderList(categoryList[selectedCategory]);\n        return () => {\n            //\n        };\n    }, [categories]);\n\n    const openModal = (product) => {\n        console.log('aaaaaaa', product);\n        setId(product._id);\n        setName(product.name);\n        if (product?.usedCategories)\n            setUsedCategories(product.usedCategories);\n\n        if (product?.discount)\n            setDiscount(product.discount);\n        else\n            setDiscount('')\n\n        console.log(usedCategories);\n    };\n    const submitHandler = (e) => {\n        e.preventDefault();\n        dispatch(\n            saveCategory({\n                _id: id,\n                selectedCategory,\n                name,\n                discount,\n                image,\n                usedCategories\n            })\n        );\n    };\n    const deleteHandler = (product) => {\n        dispatch(deleteCategory({id: product._id, selectedCategory}));\n    };\n    const onChoseCategory = (categoryName) => {\n        setRenderList(categoryList[categoryName])\n        setSelectedCategory(categoryName);\n    };\n    const uploadFileHandler = (e) => {\n        const file = e.target.files[0];\n        const bodyFormData = new FormData();\n        bodyFormData.append('image', file);\n        axios\n            .post('/api/uploads/category-image', bodyFormData, {\n                headers: {\n                    'Content-Type': 'multipart/form-data',\n                },\n            })\n            .then((response) => {\n                setImage(response.data);\n            })\n            .catch((err) => {\n                console.log(err);\n            });\n    };\n\n    const isChecked = (categoryName) => {\n        console.log(categoryName);\n        return usedCategories.findIndex(item => item === categoryName) >= 0 ? true : false;\n    };\n    const handleChangeMarks = (category) => {\n        console.log(category);\n        var usedCat = usedCategories;\n        var foundIndex = usedCat.findIndex(item => item === category.name);\n        if (foundIndex >= 0) {\n            usedCat.splice(foundIndex, 1)\n        } else {\n            usedCat.push(category.name);\n        }\n        console.log(usedCat);\n        setUsedCategories(usedCat);\n    };\n    return (\n        <div className=\"content content-margined\">\n            <div className=\"product-header mb-4\">\n                {/*<h3>Kategorije</h3>*/}\n                <ul className=\"nav header-list\">\n                    <li className=\"nav-item\" onClick={e => onChoseCategory('categories')}>\n                        <span className={`nav-link ${selectedCategory === 'categories' && 'active'}`}>Kategorije</span>\n                    </li>\n                    <li className=\"nav-item\" onClick={e => onChoseCategory('manufacturers')}>\n                        <span className={`nav-link ${selectedCategory === 'manufacturers' && 'active'}`}>Proizvodjaci</span>\n                    </li>\n                    <li className=\"nav-item\" onClick={e => onChoseCategory('seasons')}>\n                        <span className={`nav-link ${selectedCategory === 'seasons' && 'active'}`}>Sezone</span>\n                    </li>\n                    <li className=\"nav-item\" onClick={e => onChoseCategory('widths')}>\n                        <span className={`nav-link ${selectedCategory === 'widths' && 'active'}`}>Sirina</span>\n                    </li>\n                    <li className=\"nav-item\" onClick={e => onChoseCategory('heights')}>\n                        <span className={`nav-link ${selectedCategory === 'heights' && 'active'}`}>Visina</span>\n                    </li>\n                    <li className=\"nav-item\" onClick={e => onChoseCategory('diameters')}>\n                        <span className={`nav-link ${selectedCategory === 'diameters' && 'active'}`}>Precnik</span>\n                    </li>\n                </ul>\n                <button type=\"button\" className=\"btn btn-primary\" data-toggle=\"modal\" data-target=\"#exampleModal\" onClick={e => openModal({name: '', id: ''})}>\n                    Kreiraj kategoriju\n                </button>\n            </div>\n\n            <div className=\"modal fade bd-example-modal-lg\" id=\"exampleModal\" tabIndex=\"-1\" role=\"dialog\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\n                <div className=\"modal-dialog\" role=\"document\">\n                    <div className=\"modal-content\">\n                        <div className=\"modal-header\">\n                            <h2 className=\"modal-title\" id=\"exampleModalLabel\">{id ? 'Izmeni' : 'Kreiraj'} kategoriju</h2>\n                            <button type=\"button\" className=\"close\" data-dismiss=\"modal\" aria-label=\"Close\" onClick={e => {\n                                dispatch({type: CATEGORY_SAVE_REQUEST, payload: ''});\n                            }}>\n                                <span aria-hidden=\"true\">&times;</span>\n                            </button>\n                        </div>\n                        <div className=\"modal-body\">\n                            <div className=\"form-modal\">\n                                <form onSubmit={submitHandler}>\n                                    <div className=\"row\">\n                                        <div className={`${selectedCategory === 'categories' ? 'col-md-6' : 'col-md-12'}`}>\n                                            <label htmlFor=\"name\">Ime</label>\n                                            <input\n                                                type=\"text\"\n                                                name=\"name\"\n                                                value={name}\n                                                id=\"name\"\n                                                onChange={(e) => setName(e.target.value)}\n                                            />\n\n                                        </div>\n                                        {selectedCategory === 'widths' || selectedCategory === 'heights' || selectedCategory === 'diameters' ? <div className={'col-md-12'}>\n                                            <div onChange={null} className=\"marked-inputs\">\n                                                {usedCategories ? categories?.map(item => {\n                                                        return <div key={item._id} className='input-field'><input type=\"checkbox\" value={item.name}\n                                                                                                                  onChange={e => handleChangeMarks(item)}\n                                                                                                                  name={item.name}\n                                                                                                                  defaultChecked={isChecked(item.name)}/> {item.name}</div>\n                                                    }\n                                                ) : ''}\n\n                                            </div>\n                                        </div> : ''}\n                                        {selectedCategory === 'categories' && <div className=\"col-md-6\">\n                                            <label htmlFor=\"brand\">Rabat (%)</label>\n                                            <input\n                                                type=\"number\"\n                                                name=\"brand\"\n                                                value={discount}\n                                                id=\"brand\"\n                                                onChange={(e) => setDiscount(e.target.value)}\n                                            ></input>\n                                        </div>}\n                                        {selectedCategory === 'categories' && <div className=\"col-md-6\">\n                                            <label htmlFor=\"image\">Slika</label>\n                                            <input\n                                                type=\"text\"\n                                                name=\"image\"\n                                                value={image}\n                                                id=\"image\"\n                                                onChange={(e) => setImage(e.target.value)}\n                                            ></input>\n                                            <input type=\"file\"\n                                                   className=\"w-100\"\n                                                   onChange={uploadFileHandler}></input>\n                                        </div>}\n                                        <div className=\"col-md-12\">\n                                            {categorySave && categorySave.hasOwnProperty('loading') && !categorySave.loading && <div className=\"col-md-12 mt-3\">\n                                                <p className={!categorySave?.success ? 'error-text p-3' : 'success-text p-3'}>\n                                                    [STATUS] {id ? 'izmena' : 'kreiranje'} kategorije: {categorySave?.category?.message}\n                                                </p>\n                                            </div>}\n                                        </div>\n                                    </div>\n                                </form>\n                            </div>\n                        </div>\n                        <div className=\"modal-footer\">\n                            <button type=\"button\" className=\"btn btn-secondary\" id=\"close-modal-btn\" data-dismiss=\"modal\" onClick={e => {\n                                dispatch({type: CATEGORY_SAVE_REQUEST, payload: ''});\n                            }}>Odustani\n                            </button>\n                            <button type=\"submit\" className=\"btn btn-primary\" onClick={submitHandler}>\n                                {id ? 'Izmeni' : 'Kreiraj'}\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            {<div className=\"product-list\">\n                <table className=\"table\">\n                    <thead>\n                    <tr>\n                        <th>ID</th>\n                        <th>Naziv</th>\n                        <th></th>\n                    </tr>\n                    </thead>\n                    <tbody>\n                    {renderList?.map((product) => (\n                        <tr key={product._id}>\n                            <td className=\"align-center\">{product._id}</td>\n                            <td>{product.name}</td>\n                            <td>\n                                <button type=\"button\" data-toggle=\"modal\" data-target=\"#exampleModal\" className=\"button\" onClick={() => openModal(product)}>\n                                    Izmeni\n                                </button>\n                                {' '}\n                                <button\n                                    className=\"button\"\n                                    onClick={() => deleteHandler(product)}\n                                >\n                                    Obrisi\n                                </button>\n                            </td>\n                        </tr>\n                    ))}\n                    </tbody>\n                </table>\n            </div>}\n        </div>\n    );\n}\n\nexport default CategoriesScreen;\n"]},"metadata":{},"sourceType":"module"}